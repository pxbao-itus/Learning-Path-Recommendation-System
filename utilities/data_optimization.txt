// Remove redundant LO that was not teached by any courses
match(lo)<-[r]-(c:Course) where type(r) =~'TEACH_.*'
with collect(id(lo)) as lo_list, ['Tool','Knowledge','Platform','ProgramingLanguage','Framework'] as skill
match(lo) where labels(lo)[0] in skill and not id(lo) in lo_list detach delete lo;

// Upgrate property level of TEACH Relationship to 5
match(c:Course)-[r]->(lo) where type(r) =~'TEACH_.*' and type(r) <> 'TEACH_IN'
set r.Level = 5
return c,r,lo;